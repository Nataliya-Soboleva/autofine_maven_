package com.example.autofine_maven_.services;

import com.example.autofine_maven_.dto.AddFineDTO;
import com.example.autofine_maven_.dto.UpdateFineDTO;
import com.example.autofine_maven_.models.CarData;
import com.example.autofine_maven_.models.Fine;
import com.example.autofine_maven_.repository.CarDataRepository;
import com.example.autofine_maven_.repository.FineRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;
import java.util.NoSuchElementException;

@Service
public class FineService implements IFineService{

    @Autowired
    private CarDataRepository carDataRepository;

    @Autowired
    private FineRepository fineRepository;


    @Override
    public List<Fine> allByCarDataId(Long id)
    {
        List<Fine> allFinesById = new ArrayList<>();
        try{
            fineRepository.findByCarDataId(id).forEach(allFinesById::add);
        }
        catch (NoSuchElementException e) {}
        finally {
            return allFinesById;
        }
    }

    @Override
    public Fine add(AddFineDTO addFineDTO)
    {
        Fine addFined = new Fine();
        Fine addFined1 = new Fine();
        addFined.setId(0l);

        try{
            CarData carData = carDataRepository.findById(addFineDTO.getCarDataId()).get();
            addFined.setCarDataId(carData);
            addFined.setDateOfViolation(addFineDTO.getDateOfViolation());
            addFined.setTypeOfViolation(addFineDTO.getTypeOfViolation());
            addFined.setDecreeNumber(addFineDTO.getDecreeNumber());
            addFined.setAmountOfTheFine(addFineDTO.getAmountOfTheFine());
            addFined.setPayment(addFineDTO.getPayment());
            addFined.setImage(addFineDTO.getImage());
            // addFined.setImage(new byte[]{-1,-40,-1,-32,0,16,74,70,73,70,0,1,2,0,0,1,0,1,0,0,-1,-37,0,67,0,8,6,6,7,6,5,8,7,7,7,9,9,8,10,12,20,13,12,11,11,12,25,18,19,15,20,29,26,31,30,29,26,28,28,32,36,46,39,32,34,44,35,28,28,40,55,41,44,48,49,52,52,52,31,39,57,61,56,50,60,46,51,52,50,-1,-37,0,67,1,9,9,9,12,11,12,24,13,13,24,50,33,28,33,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,-1,-64,0,17,8,0,83,0,100,3,1,34,0,2,17,1,3,17,1,-1,-60,0,31,0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,-1,-60,0,-75,16,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125,1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,-127,-111,-95,8,35,66,-79,-63,21,82,-47,-16,36,51,98,114,-126,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,-125,-124,-123,-122,-121,-120,-119,-118,-110,-109,-108,-107,-106,-105,-104,-103,-102,-94,-93,-92,-91,-90,-89,-88,-87,-86,-78,-77,-76,-75,-74,-73,-72,-71,-70,-62,-61,-60,-59,-58,-57,-56,-55,-54,-46,-45,-44,-43,-42,-41,-40,-39,-38,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-1,-60,0,31,1,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,-1,-60,0,-75,17,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119,0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,-127,8,20,66,-111,-95,-79,-63,9,35,51,82,-16,21,98,114,-47,10,22,36,52,-31,37,-15,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,-126,-125,-124,-123,-122,-121,-120,-119,-118,-110,-109,-108,-107,-106,-105,-104,-103,-102,-94,-93,-92,-91,-90,-89,-88,-87,-86,-78,-77,-76,-75,-74,-73,-72,-71,-70,-62,-61,-60,-59,-58,-57,-56,-55,-54,-46,-45,-44,-43,-42,-41,-40,-39,-38,-30,-29,-28,-27,-26,-25,-24,-23,-22,-14,-13,-12,-11,-10,-9,-8,-7,-6,-1,-38,0,12,3,1,0,2,17,3,17,0,63,0,91,45,62,-9,82,-72,-5,61,-123,-92,-73,51,99,59,80,12,47,-44,-110,0,-4,77,70,12,-38,86,-94,-34,125,-67,-84,-77,68,72,-14,-28,43,50,41,-9,-38,74,-110,61,14,113,-23,-102,-83,42,-62,29,-60,123,-116,123,-66,83,39,83,-11,0,-102,102,71,78,-33,74,0,125,-35,-44,-41,-105,13,52,-94,48,79,-16,-59,24,68,81,-24,21,70,5,87,-40,-58,-92,-37,-33,53,-124,-34,40,-126,61,94,75,55,17,71,28,115,24,-103,-34,78,120,56,39,31,-121,74,0,-101,87,-68,48,21,-76,-119,55,-55,34,-106,108,18,54,-81,78,-93,-90,106,-84,122,-114,-86,-80,-84,49,109,-118,21,24,84,81,-128,63,90,-114,-47,-102,-16,-53,127,32,-61,-36,57,96,-65,-35,65,-62,-113,-26,127,26,-48,-114,61,-46,-94,-112,23,3,-71,-19,-42,-128,41,-76,-102,-93,46,-17,-76,-16,113,-62,-127,-2,20,-13,109,-88,19,-122,-67,63,64,-30,-91,73,-93,-123,-39,-38,84,93,-71,-22,71,90,-120,-36,69,-100,-7,-15,47,-71,113,64,12,-14,-17,80,-100,-35,63,94,-92,-42,38,-93,119,117,13,-46,40,-101,111,-106,-40,24,61,24,18,115,-8,-125,93,25,-106,-38,72,-111,62,-43,0,44,120,38,69,-57,-29,-51,115,58,-33,-107,-10,-62,21,-60,-65,50,-112,-23,-106,4,-29,110,6,58,-12,6,-128,58,-37,59,-108,-68,-76,73,-44,117,-5,-64,127,9,-18,42,-52,19,125,-102,-23,37,16,67,51,33,-56,-114,117,-36,-97,-16,33,-98,126,-107,-54,104,-6,-75,-54,-33,-59,101,44,102,40,91,-27,10,-47,-19,42,-57,-111,-41,-98,79,-13,-82,-75,34,-57,65,-49,-13,-96,9,53,43,-5,-115,94,-6,75,-51,69,-34,-30,-30,79,-30,-24,0,-20,0,-20,7,-91,20,-101,71,-65,-27,69,0,77,-12,-89,5,-25,-89,-32,105,-63,63,15,-83,63,-113,76,126,52,1,25,81,-100,-2,-126,-79,-11,79,34,-14,83,2,-3,-105,116,37,26,118,-111,55,-72,92,-28,34,-15,-44,-29,-16,31,90,-39,35,39,12,9,31,94,-75,-103,-31,61,2,-61,-59,126,26,109,78,127,19,11,93,93,29,-124,-106,-46,-50,-128,50,-105,-22,23,1,-128,10,70,14,79,60,112,5,0,84,109,27,69,105,12,-86,-79,-96,115,-69,103,-54,-61,-11,82,71,-48,28,83,-66,-59,-92,-58,49,-104,-64,-12,3,-1,0,-83,88,126,37,-126,127,11,-22,-110,-40,92,17,46,-44,89,35,-112,12,111,86,29,113,-97,92,-114,-68,-29,53,-109,107,-88,-36,-33,76,33,-73,-119,11,-29,-85,-56,16,117,3,-87,56,-22,64,-4,104,3,-81,-14,116,84,-50,8,-49,-80,-1,0,-21,83,3,105,73,-9,99,-4,-114,43,-99,-69,-2,-47,-78,-75,-5,68,-79,67,-80,127,114,-32,18,70,16,-1,0,41,35,63,-16,49,-24,113,66,-33,89,-106,105,66,96,-89,-5,89,-49,30,-12,1,-40,52,-6,122,-116,36,36,-79,-32,97,-51,84,-102,40,13,-43,-75,-46,-77,22,-75,-108,59,50,48,-61,47,0,-128,15,83,-1,0,-22,-83,93,23,72,-48,100,-45,108,-81,117,-115,126,-35,90,99,19,-49,2,94,-82,82,54,108,-74,17,14,-16,-54,-99,114,126,-15,-24,113,89,94,51,-66,-16,-28,122,-108,54,-34,21,92,-38,91,-85,-18,-101,116,-124,-56,-59,-66,94,100,57,-32,1,-8,-109,-37,20,1,-105,112,-49,110,-73,55,38,83,36,-103,-13,55,30,14,70,77,119,113,102,72,99,124,96,-78,-125,-57,-46,-72,9,11,-49,-92,121,-116,50,-14,-60,56,29,-37,21,-24,49,-100,91,-60,84,113,-79,113,-97,-91,0,70,71,63,-3,106,42,66,-57,52,80,5,-125,-33,-127,76,39,-114,41,11,-11,30,-11,25,124,117,-51,0,76,-128,22,92,-127,-116,-12,61,-21,-57,-80,96,-34,21,92,-94,54,-62,67,-29,-102,-11,118,-72,8,-64,-125,-48,-11,-81,35,-70,-109,109,-60,-86,85,114,-82,-61,-11,-96,9,-91,-111,100,-124,-115,-116,50,7,53,-42,-8,119,-61,26,94,-81,101,30,-91,121,-30,-31,-89,93,59,50,-72,-110,68,-34,0,-29,57,46,14,56,-82,32,49,85,-36,33,-21,-48,-45,76,-89,57,33,127,16,63,-62,-127,-90,122,51,-8,75,-61,-115,17,23,94,56,71,3,7,96,-103,95,61,-67,72,-82,51,80,-75,-78,-45,117,-85,-120,108,-82,126,-39,107,19,16,-109,103,27,-57,-81,-75,101,-7,-57,-46,63,-5,-26,-105,-19,4,118,-116,-113,77,-94,-128,-71,98,75,-110,-17,-116,38,61,73,39,20,101,-124,-37,11,33,10,122,-89,67,-8,-43,95,53,-119,-32,40,-6,10,116,83,31,49,3,30,55,12,-113,106,4,107,77,126,-111,91,-59,105,-60,-114,84,33,0,-16,-94,-67,22,-34,-31,13,-84,0,55,72,-44,117,-10,-81,60,-76,-48,-46,-30,79,50,77,-32,19,-100,3,-118,-21,32,66,-118,0,7,-90,58,-48,6,-33,-103,-17,69,81,8,-28,103,52,80,6,-33,-107,-114,0,-88,-98,22,53,127,96,61,122,-9,-91,11,-58,125,121,-59,0,97,-49,105,43,3,-74,-72,-51,67,-63,-73,-45,94,-51,60,78,-69,100,114,-8,35,-100,-98,79,-11,-81,80,-14,-105,28,-114,-93,-67,55,-54,94,-69,113,-8,80,7,-109,-73,-124,-75,93,-95,112,8,2,-93,-1,0,-124,63,83,45,-76,-57,-49,127,106,-11,-109,24,103,-40,-86,55,127,19,99,-89,-1,0,95,-4,-6,83,-59,-70,-88,-38,-93,-41,-91,0,121,40,-16,86,-90,127,-127,127,58,122,-8,31,82,61,85,71,-44,-41,-83,-120,115,-56,28,122,-6,81,-79,115,-112,6,61,104,3,-54,-45,-64,122,-119,35,115,42,-2,53,102,47,-121,-14,110,6,91,-94,57,-24,-94,-67,37,-111,71,64,62,-75,25,24,-9,-96,14,122,-33,68,91,120,-111,3,18,20,1,-109,-42,-83,-57,96,-93,-100,-13,-18,43,72,-81,-51,-49,31,-46,-126,7,64,48,104,2,-96,-74,4,125,-47,-57,20,85,-49,43,-36,-113,106,40,2,-38,-88,-32,-2,70,-100,16,14,-33,-121,-67,112,-47,-8,-61,80,41,9,104,-94,15,34,-60,113,-75,15,37,75,55,6,78,7,3,25,-57,-65,-91,72,-34,45,-44,-73,42,-94,-37,-125,-75,-77,-72,47,13,-4,63,-57,-45,57,-51,0,119,54,-16,75,117,113,29,-67,-68,79,52,-46,28,36,107,-44,-2,125,62,-67,-86,-34,-77,-93,-55,-92,78,-74,-49,121,111,44,-60,-27,-110,18,73,-116,123,-15,-41,-89,31,-113,-41,-50,-12,-17,-116,87,-6,47,-38,62,-63,13,-70,-76,-124,-113,58,75,77,-46,109,-57,3,62,102,7,60,-29,24,-6,-42,52,-65,19,117,102,-69,118,-14,-19,-35,29,-9,51,-55,27,121,-121,61,73,-7,-71,52,1,-23,-86,-126,52,-64,3,104,-12,-26,-98,20,103,57,-21,-19,92,53,-73,-116,-17,-18,-93,-13,97,-119,90,54,32,38,81,21,-119,-6,25,57,-28,127,-115,36,-98,54,-44,18,102,69,-114,13,-101,-74,43,1,25,-55,32,-98,113,46,49,-64,-25,56,-21,64,29,-47,28,-126,71,30,-35,-24,39,25,-55,-25,-114,-3,-85,-118,-73,-15,-122,-91,35,64,-77,-57,109,26,-77,5,-109,107,-60,49,-56,25,25,-105,-41,-114,127,-91,84,-125,-58,90,-69,-38,-105,-102,43,79,57,-105,49,8,-54,109,-28,113,-112,100,4,119,-49,-31,-21,64,29,-63,98,73,92,117,-49,95,74,-115,-125,112,56,60,-6,87,41,-1,0,9,85,-40,-107,-127,104,-111,0,98,119,44,68,-1,0,-77,-46,110,115,-126,14,63,-6,-43,19,120,-78,-15,34,18,57,-116,-126,23,37,99,-120,-32,29,-35,-124,-34,-53,-6,-25,-74,64,58,-4,124,-71,-2,116,5,57,-55,25,111,-83,114,18,-8,-86,-2,34,-20,76,76,-79,38,-10,41,12,110,122,-111,-50,39,60,112,126,-104,-90,-55,-30,-67,69,100,-106,52,88,50,-117,-72,101,80,-15,-37,56,-109,-114,-33,79,113,64,29,-98,49,-58,5,21,-25,-6,-113,-114,-75,75,73,-93,91,116,-74,10,-55,-72,-17,81,-100,-18,35,-8,95,29,-123,20,1,-54,38,-81,118,-112,-128,5,-79,10,0,27,-83,98,108,-116,14,-71,94,127,26,85,-43,-82,-104,93,49,91,96,-37,6,10,-38,-60,49,-13,99,-116,47,28,49,-3,61,5,20,80,2,46,-81,118,124,-60,-52,24,100,117,39,-20,-47,-25,5,72,60,-19,-49,74,-54,-94,-118,0,43,85,53,-69,-33,36,6,-5,51,109,93,-125,125,-92,76,66,-6,100,-83,20,80,3,127,-74,47,24,-85,127,-93,-125,-13,3,-74,-42,32,15,3,-88,11,-49,65,79,125,110,-16,49,1,44,-16,25,-65,-27,-54,31,-2,34,-118,40,1,-85,-84,93,-87,-119,-128,-74,4,54,113,-10,72,-79,-48,14,-101,112,120,-92,125,94,-17,106,-96,22,-54,50,-83,-108,-75,-119,78,126,-95,115,69,20,0,38,-83,117,12,106,-120,45,-126,-60,-61,110,109,98,57,-21,-41,43,-13,126,57,-88,-29,-44,-82,-110,32,-118,-47,-123,4,-112,60,-108,-21,-125,-19,-18,104,-94,-128,34,-70,-67,-98,-31,-111,-91,40,72,82,7,-18,-44,113,-72,-98,-61,-36,-47,69,20,1,-1,-39});

            addFined1 = fineRepository.save(addFined);
            System.out.println(addFined.getId().toString());
        }
        catch(NoSuchElementException e)
        {
            e.getStackTrace();
        }
        finally {
            return  addFined1;
        }
    }
    @Override
    public Fine update(UpdateFineDTO updateFineDTO)
    {
        Fine fineToUpdate = new Fine();
        try{
            fineToUpdate = fineRepository.findById(updateFineDTO.getId()).get();


            fineToUpdate.setAmountOfTheFine(updateFineDTO.getAmountOfTheFine());
            fineToUpdate.setPayment(updateFineDTO.getPayment());
            fineToUpdate = fineRepository.save(fineToUpdate);

        }
        catch(NoSuchElementException e){}
        finally {
            return  fineToUpdate;
        }
    }
    @Override
    public Boolean delete(Long id)
    {
        try{
            Fine fineToDelete = fineRepository.findById(id).get();
            fineRepository.delete(fineToDelete);
            return true;
        }
        catch(NoSuchElementException e){}
        return false;

    }


}
